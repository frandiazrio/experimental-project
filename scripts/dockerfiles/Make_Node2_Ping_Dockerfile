# build the executable binary
FROM golang:alpine AS builder-node-2

#install git and other stuff

RUN apk update && apk add git && apk add tree 

WORKDIR /project/

COPY . .



# I am lazy
ENV TEST_DIR ./testing/test-ping 

#RUN cd ${TEST_DIR}/node1 && go build -o node_1
RUN cd ${TEST_DIR}/node2 && go build -o node_2 

RUN tree /project


#Step 2 build a small image

FROM alpine:latest


#COPY --from=builder /project/testing/test-ping/node1/node_1 /
 
COPY --from=builder-node-2 /project/testing/test-ping/node2/node_2 /
# change this at will
CMD ["./node_2"]
